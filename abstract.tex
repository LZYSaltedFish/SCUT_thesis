\chapter{摘\texorpdfstring{\quad}{}要}

垂直领域对话生成技术是构建智能对话系统中重要的基础技术，该技术旨在为用户解决特定领域的问题、提供专业解答。目前该技术已经广泛应用在医疗保健、金融、法律、科技等领域的服务助手、答疑机器人等应用中，具有很高的研究价值。目前主流的面向垂直领域的对话生成方法，都是基于检索增强的语言模型设计的。然而，现有面向垂直领域的检索增强对话生成任务存在以下难点：1）内外部知识不一致问题，即现有方法多关注如何提升外部知识召回准确度，忽略了模型内部知识与之存在的分布差异，从而影响外部知识发挥作用；2）人类偏好对齐问题，即人类用户意图与模型理解之间存在偏差，造成模型生成不符合用户预期的回答。针对以上存在的两个问题，本文采取的研究方案如下：

\begin{enumerate}[topsep = 0 pt, itemsep= 0 pt, parsep=0pt, partopsep=0pt, leftmargin=0pt, itemindent=44pt, labelsep=6pt, listparindent=24pt, label=\arabic*)]
	\item 针对内外部知识不一致的问题，提出了基于内外部知识对齐的检索增强对话生成方法。该方法利用一个语义切分模块提取知识文档的文档级信息和实体级信息，并将提取出来的信息分别用于构建外部知识库和监督训练数据集，最后使用知识对齐后的数据集微调对话模型，有效缓解了模型在预训练阶段注入的内部知识与推理阶段的外部知识不一致的问题。本文将该方法应用于金融领域、云计算领域和法律领域，在各领域知识问答任务和金融领域股票价格预测任务上验证了该方法的有效性。

	\item 针对人类偏好对齐的问题，提出了基于人类偏好对齐的检索增强对话生成方法。该方法通过采集人类对真实场景对话样本的偏好信息，并利用大型语言模型的推理与分析能力进行用户问题优化，构成优化问题三元组数据集，用以训练单独的用户问题优化器，而无需训练对话模型，实现了与模型无关的、可解释的、效果稳定的人类偏好对齐。本文分别在三个不同的垂直领域基准测试集上与目前主流的语言模型对齐方法进行实验比较，证明了本文方法能够同时提升知识文档召回准确率和模型理解与用户意图的一致性。
\end{enumerate}

综上所述，本文提出分别从内外部知识和人类偏好两个层面进行数据对齐，相较于现有方法，能够有效提升语言模型在垂直领域检索增强场景下对话生成的稳定性、可控性和准确性。

\keywordsCN{对话系统；人类偏好对齐；检索增强生成；自回归语言模型}

\chapter{Abstract}

Vertical domain dialogue generation is an important basic technology in building intelligent dialogue system, which aims to solve problems in specific fields and provide professional answers for users. At present, the technology has been widely used in service assistants, question\&answering robots and other applications for the fields of health care, finance, law, science, which has a high research value. At present, the mainstream vertical domain oriented dialogue generation methods are all designed based on retrieval augmented language models. However, the existing vertical domain oriented retrieval augmented dialogue generation has the following difficulties: 1) internal and external knowledge inconsistency problem, that is, the existing methods mainly focus on how to improve the accuracy of external knowledge recall, ignoring the distribution difference between the model's internal knowledge and it, thus affecting the role of external knowledge; 2) Human preference alignment problem, that is, there is a deviation between human user intent and model understanding, causing the model to generate answers that do not meet user expectations. In view of the above two problems, the research plan adopted in this paper is as follows:

\begin{enumerate}[topsep = 0 pt, itemsep= 0 pt, parsep=0pt, partopsep=0pt, leftmargin=0pt, itemindent=44pt, labelsep=6pt, listparindent=24pt, label=\arabic*)]
	\item Aiming at the problem of internal and external knowledge inconsistency, a retrieval augmented dialogue generation method based on internal and external knowledge alignment is proposed. In this method, a semantic segmentation module is used to extract document-level information and entity-level information from knowledge documents, and the extracted information is used to build external knowledge base and supervised training dataset respectively. Finally, the knowledge aligned dataset is used to fine-tune the dialogue model, which effectively avoids the inconsistency between the internal knowledge injected into the model in the pre-training stage and the external knowledge in the inference stage. In this paper, the method is applied to financial analysis domain, and the validity of the method is verified on real-world stock trend prediction task and financial question\&answering task.

	\item Aiming at the problem of human preference alignment, a retrieval augmented dialogue generation method based on human preference alignment is proposed. By collecting human preference information for real-world dialogue corpus, the method utilizes the reasoning and analysis capabilities of large language models to optimize user query, and constructs a triplet dataset of optimized queries to train a single user query optimizer instead of training the dialogue model, which achieves model-agnostic, interpretable and stable human preference alignment. In this paper, we compare with the current mainstream language model alignment methods on three different vertical domain benchmarks, and prove that the method can improve the accuracy of knowledge document recall and the consistency of model understanding and user intent.
\end{enumerate}

In summary, this paper proposes that data alignment from the two levels of internal and external knowledge and human preference can effectively improve the stability, controllability and accuracy of the vertical domain retrieval augmented dialogue generation of language models compared to the existing methods.

\keywordsEN{Dialogue System; Human Preference Alignment; Retrieval Augmented Generation; Regressive Language Model}